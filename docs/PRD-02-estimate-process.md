# PRD-02: 견적 입력 프로세스

> **프로젝트**: ezpz - 창호 견적 비교 웹서비스
> **버전**: 1.0
> **최종 수정**: 2026-02-10

---

## 1. 개요

이 문서는 사용자가 창호 견적을 받기 위해 거치는 **5단계 입력 프로세스**의 기능 요구사항과 UI 명세를 정의합니다.

### 대상 라우트

| 라우트 | 페이지 | 설명 |
|--------|--------|------|
| `/estimate` | 견적 시작 | Bottom Sheet (이전 견적 / 새 견적) |
| `/estimate/step1` | Step 1 | 필수 정보 (이름, 전화번호) |
| `/estimate/step2` | Step 2 | 주소 입력 |
| `/estimate/step3` | Step 3 | 창 유형 선택 |
| `/estimate/step4` | Step 4 | 규격 입력 |
| `/estimate/step5` | Step 5 | 갯수 입력 |
| `/estimate/result` | 견적 결과 | → PRD-03 참조 |

### 전체 흐름

```
[랜딩 CTA] → [견적 시작 Bottom Sheet] → [Step 1] → [Step 2] → [Step 3] → [Step 4] → [Step 5] → [결과]
                                                                    ↓ Skip     ↓ Skip     ↓ Skip
                                                                   [Step 4]   [Step 5]   [결과]
```

---

## 2. Progress Indicator

모든 Step 화면 상단에 진행 상태를 표시합니다.

### 2.1 UI 구성

```
Step 1    Step 2    Step 3    Step 4    Step 5
  ●─────────●─────────○─────────○─────────○
 완료      현재      미완료
```

| 상태 | 스타일 |
|------|--------|
| 완료 | 채워진 원 (Primary Color) + 실선 연결 |
| 현재 | 채워진 원 (Primary Color) + 라벨 Bold |
| 미완료 | 빈 원 (Gray 300) + 점선 연결 |
| Skip됨 | 빈 원 + 대시선 (Gray 300) |

### 2.2 라벨

| Step | 라벨 |
|------|------|
| 1 | 기본 정보 |
| 2 | 주소 |
| 3 | 창 유형 |
| 4 | 규격 |
| 5 | 갯수 |

---

## 3. 견적 시작 (`/estimate`)

### 3.1 진입 조건

- 랜딩페이지 CTA 버튼 클릭
- 또는 햄버거 메뉴 > "견적 시작하기" 클릭

### 3.2 Bottom Sheet

화면 하단에서 슬라이드-업 되는 Bottom Sheet를 표시합니다.

```
┌─────────────────────────────┐
│         ── (핸들)            │
│                             │
│   이전에 작성한 견적이       │
│   있습니다. 불러올까요?      │
│                             │
│  ┌─────────────────────┐    │
│  │  이전 견적 불러오기   │    │  → 저장된 데이터 복원 후 이어서 진행
│  └─────────────────────┘    │
│  ┌─────────────────────┐    │
│  │  새 견적 확인하기     │    │  → 기존 데이터 초기화 후 Step 1
│  └─────────────────────┘    │
│                             │
└─────────────────────────────┘
```

### 3.3 분기 로직

| 조건 | 동작 |
|------|------|
| 이전 견적 데이터 **있음** (localStorage) | Bottom Sheet 표시 |
| 이전 견적 데이터 **없음** | Bottom Sheet 생략, 바로 Step 1 이동 |
| "이전 견적 불러오기" 선택 | 저장된 데이터 로드 → 마지막 완료 Step 다음으로 이동 |
| "새 견적 확인하기" 선택 | localStorage 초기화 → Step 1 이동 |

### 3.4 데이터 저장

- 각 Step 완료 시 **localStorage**에 자동 저장
- 저장 키: `ezpz_estimate_draft`
- 저장 형식:

```json
{
  "lastStep": 3,
  "createdAt": "2026-02-10T12:00:00Z",
  "data": {
    "name": "홍길동",
    "phone": "01012345678",
    "address": { ... },
    "windowType": "expanded",
    "dimensions": { ... },
    "quantity": 5
  }
}
```

---

## 4. Step 1 — 필수 정보 (`/estimate/step1`)

### 4.1 Header

| 요소 | 동작 |
|------|------|
| ← 뒤로가기 | 이전 화면으로 이동 (랜딩 또는 Bottom Sheet) |
| 타이틀 | "견적 정보 입력" |

### 4.2 입력 필드

| 필드 | 타입 | Placeholder | 필수 | Validation |
|------|------|-------------|------|------------|
| 이름 | text | 이름을 입력해주세요 | Y | 2~20자, 한글/영문만 |
| 전화번호 | tel | 010-0000-0000 | Y | 010 시작, 숫자 10~11자리 |

### 4.3 전화번호 포맷팅

- 자동 하이픈 삽입: `010-1234-5678`
- 입력 시 숫자만 허용 (문자 입력 차단)
- 포맷: `XXX-XXXX-XXXX` (11자리) 또는 `XXX-XXX-XXXX` (10자리)

### 4.4 Validation 규칙

| 필드 | 에러 조건 | 에러 메시지 |
|------|-----------|-------------|
| 이름 | 미입력 | "이름을 입력해주세요" |
| 이름 | 2자 미만 | "이름은 2자 이상 입력해주세요" |
| 이름 | 특수문자/숫자 포함 | "한글 또는 영문만 입력 가능합니다" |
| 전화번호 | 미입력 | "전화번호를 입력해주세요" |
| 전화번호 | 010 미시작 | "010으로 시작하는 번호를 입력해주세요" |
| 전화번호 | 자릿수 부족 | "올바른 전화번호를 입력해주세요" |

### 4.5 버튼

- **"다음"** — Primary Button, 하단 고정
- 모든 필수 필드 유효 시 활성화
- 비활성 상태: Gray 배경, 클릭 불가

### 4.6 UI 상태

| 상태 | 설명 |
|------|------|
| 초기 | 빈 폼, "다음" 버튼 비활성 |
| 입력 중 | 포커스된 필드 Primary border |
| 에러 | 필드 하단 에러 메시지 (Red) |
| 완료 | 모든 필드 유효, "다음" 버튼 활성 |

---

## 5. Step 2 — 주소 입력 (`/estimate/step2`)

### 5.1 Header

| 요소 | 동작 |
|------|------|
| ← 뒤로가기 | Step 1로 이동 |
| 타이틀 | "주소 입력" |

### 5.2 입력 필드

| 필드 | 타입 | Placeholder | 필수 | Validation |
|------|------|-------------|------|------------|
| 주소 검색 | button/input | 주소를 검색해주세요 | Y | 주소 API 선택 필수 |
| 상세 주소 | text | 상세 주소를 입력해주세요 (동/호) | N | 최대 100자 |
| 층수 | number | 층수를 입력해주세요 | N | 1~99 숫자 (미입력 허용) |

### 5.3 주소 검색 연동

**사용 API**: 카카오 주소 검색 API (또는 다음 우편번호 API)

**동작 흐름:**
1. "주소 검색" 필드 클릭 → 주소 검색 팝업/모달 오픈
2. 사용자가 주소 검색 & 선택
3. 선택된 주소가 필드에 자동 채워짐
4. 상세 주소 필드로 포커스 이동

**저장 데이터:**
```json
{
  "zonecode": "06234",
  "address": "서울 강남구 테헤란로 123",
  "addressDetail": "101동 1501호",
  "floor": 15              // optional, nullable
}
```

### 5.4 Validation 규칙

| 필드 | 에러 조건 | 에러 메시지 |
|------|-----------|-------------|
| 주소 | 미선택 | "주소를 검색해주세요" |
| 층수 | 범위 초과 | "1~99 사이의 숫자를 입력해주세요" (입력 시에만 검증) |

### 5.5 버튼

- **"다음"** — Primary Button, 하단 고정
- 주소 선택 시 활성화 (층수는 선택 사항)

---

## 6. Step 3 — 창 유형 선택 (`/estimate/step3`)

### 6.1 Header

| 요소 | 동작 |
|------|------|
| ← 뒤로가기 | Step 2로 이동 |
| 타이틀 | "창 유형 선택" |

### 6.2 선택지

카드 형태의 라디오 선택 UI:

```
┌─────────────────────────┐
│  ☐  확장 발코니           │
│     발코니를 확장한 창호   │
│                    ⓘ     │
└─────────────────────────┘

┌─────────────────────────┐
│  ☐  비확장 발코니         │
│     기존 발코니 창호      │
│                    ⓘ     │
└─────────────────────────┘
```

### 6.3 Info 툴팁

ⓘ 아이콘 클릭 시 툴팁 또는 바텀시트로 상세 설명 표시:

| 유형 | 설명 |
|------|------|
| 확장 발코니 | 발코니를 거실/방으로 확장한 경우의 외벽 창호입니다. 일반적으로 이중창 구조입니다. |
| 비확장 발코니 | 기존 발코니 구조를 유지한 경우의 창호입니다. 단창 또는 이중창 구조입니다. |

**툴팁 UI:**
- 배경: 흰색, 그림자(elevation 4)
- 텍스트: body2, Gray 900
- 닫기: 외부 클릭 또는 X 버튼

### 6.4 Skip 가능

- **"건너뛰기"** 텍스트 버튼 (하단 "다음" 버튼 위)
- 클릭 시: `windowType = null`로 저장, Step 4로 이동

### 6.5 버튼

| 버튼 | 조건 | 동작 |
|------|------|------|
| "건너뛰기" | 항상 표시 | Step 4로 이동 (windowType = null) |
| "다음" | 유형 선택 시 활성 | Step 4로 이동 (선택값 저장) |

### 6.6 UI 상태

| 상태 | 설명 |
|------|------|
| 초기 | 아무것도 선택되지 않음, "다음" 비활성 |
| 선택됨 | 선택된 카드 Primary border + 체크 아이콘, "다음" 활성 |
| 툴팁 열림 | 해당 유형의 상세 설명 표시 |

---

## 7. Step 4 — 규격 입력 (`/estimate/step4`)

### 7.1 Header

| 요소 | 동작 |
|------|------|
| ← 뒤로가기 | Step 3로 이동 |
| 타이틀 | "규격 입력" |

### 7.2 안내 문구

> 창문의 **안쪽 치수**를 입력해주세요.
> 정확한 견적을 위해 가로와 세로를 측정해주세요.

### 7.3 입력 필드

| 필드 | 타입 | 단위 | Placeholder | 필수 | Validation |
|------|------|------|-------------|------|------------|
| 가로 | number | mm | 가로 (mm) | Y* | 100~10000 |
| 세로 | number | mm | 세로 (mm) | Y* | 100~10000 |

*Skip 가능하므로 입력 시에만 필수

### 7.4 Info 툴팁

ⓘ "안쪽 치수란?" 클릭 시:

- 일러스트 이미지: 창틀 안쪽을 측정하는 방법 그림
- 설명: "창틀의 안쪽 가장자리에서 반대쪽 안쪽 가장자리까지의 거리를 측정해주세요."
- "자세히 보기" 링크 → `/help/measurement` (도움말 상세)

### 7.5 Validation 규칙

| 필드 | 에러 조건 | 에러 메시지 |
|------|-----------|-------------|
| 가로 | 100mm 미만 | "100mm 이상 입력해주세요" |
| 가로 | 10000mm 초과 | "10000mm 이하로 입력해주세요" |
| 세로 | 100mm 미만 | "100mm 이상 입력해주세요" |
| 세로 | 10000mm 초과 | "10000mm 이하로 입력해주세요" |
| 가로/세로 | 하나만 입력 | "가로와 세로 모두 입력해주세요" |

### 7.6 Skip 가능

- **"건너뛰기"** 텍스트 버튼
- 클릭 시: `dimensions = null`로 저장, Step 5로 이동

### 7.7 버튼

| 버튼 | 조건 | 동작 |
|------|------|------|
| "건너뛰기" | 항상 표시 | Step 5로 이동 (dimensions = null) |
| "다음" | 가로 + 세로 유효 시 활성 | Step 5로 이동 (치수 저장) |

---

## 8. Step 5 — 갯수 입력 (`/estimate/step5`)

### 8.1 Header

| 요소 | 동작 |
|------|------|
| ← 뒤로가기 | Step 4로 이동 |
| 타이틀 | "갯수 입력" |

### 8.2 안내 문구

> 교체할 창의 갯수를 입력해주세요.

### 8.3 입력 UI

**Stepper 컴포넌트:**

```
         ┌───┐  ┌─────┐  ┌───┐
         │ - │  │  1  │  │ + │
         └───┘  └─────┘  └───┘
```

| 요소 | 동작 |
|------|------|
| − 버튼 | 수량 1 감소 (최소 1) |
| 수량 표시 | 현재 수량 (직접 입력 가능) |
| + 버튼 | 수량 1 증가 (최대 99) |

### 8.4 Validation 규칙

| 에러 조건 | 에러 메시지 |
|-----------|-------------|
| 0 이하 | "1개 이상 입력해주세요" |
| 100 이상 | "99개 이하로 입력해주세요" |
| 비숫자 | 숫자만 허용 |

### 8.5 Skip 가능

- **"건너뛰기"** 텍스트 버튼
- 클릭 시: `quantity = null`로 저장, 견적 결과로 이동

### 8.6 버튼

| 버튼 | 조건 | 동작 |
|------|------|------|
| "건너뛰기" | 항상 표시 | 결과 페이지로 이동 (quantity = null) |
| "견적 확인하기" | 갯수 유효 시 활성 | API 호출 후 결과 페이지로 이동 |

---

## 9. 견적 제출 API

Step 5 완료 (또는 Skip) 시 서버에 견적 요청을 전송합니다.

### 9.1 Request

```
POST /api/estimates
Content-Type: application/json

{
  "name": "홍길동",
  "phone": "01012345678",
  "address": {
    "zonecode": "06234",
    "address": "서울 강남구 테헤란로 123",
    "addressDetail": "101동 1501호",
    "floor": 15 | null
  },
  "windowType": "expanded" | "non-expanded" | null,
  "dimensions": {
    "width": 1800,
    "height": 2100
  } | null,
  "quantity": 5 | null
}
```

### 9.2 Response

```json
{
  "success": true,
  "estimateId": "est_abc123",
  "results": [
    {
      "brand": "LX",
      "brandName": "LX 하우시스",
      "minPrice": 1000000,
      "maxPrice": 1500000,
      "pricePerUnit": { "min": 200000, "max": 300000 },
      "pricePerPyeong": { "min": 150000, "max": 200000 },
      "installationCount": 1200
    },
    {
      "brand": "KCC",
      "brandName": "KCC 글라스",
      "minPrice": 900000,
      "maxPrice": 1400000,
      "pricePerUnit": { "min": 180000, "max": 280000 },
      "pricePerPyeong": { "min": 130000, "max": 180000 },
      "installationCount": 950
    },
    {
      "brand": "CHUNGAM",
      "brandName": "청암",
      "minPrice": 800000,
      "maxPrice": 1200000,
      "pricePerUnit": { "min": 160000, "max": 240000 },
      "pricePerPyeong": { "min": 110000, "max": 160000 },
      "installationCount": 800
    }
  ]
}
```

### 9.3 로딩 상태

- API 호출 중: 전체 화면 로딩 오버레이 + 스피너
- 로딩 문구: "견적을 계산하고 있습니다..."
- 타임아웃: 15초 초과 시 "시간이 초과되었습니다. 다시 시도해주세요" 에러

### 9.4 에러 처리

| 에러 코드 | 메시지 | 동작 |
|-----------|--------|------|
| 400 | 입력 정보를 확인해주세요 | 에러 필드 하이라이트, 해당 Step으로 이동 |
| 429 | 요청이 너무 많습니다 | "잠시 후 다시 시도해주세요" 토스트 |
| 500 | 서버 오류 | "일시적인 오류가 발생했습니다" + 재시도 버튼 |

---

## 10. 데이터 흐름 요약

```
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│ Step 1  │───▶│ Step 2  │───▶│ Step 3  │───▶│ Step 4  │───▶│ Step 5  │
│ 이름    │    │ 주소    │    │ 창 유형  │    │ 규격    │    │ 갯수    │
│ 전화번호│    │ 층수    │    │ (Skip?) │    │ (Skip?) │    │ (Skip?) │
└─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘
     │              │              │              │              │
     ▼              ▼              ▼              ▼              ▼
  localStorage   localStorage   localStorage   localStorage   API 호출
  자동 저장      자동 저장      자동 저장      자동 저장      + 결과 이동
```

### 10.1 필수 vs 선택 정보

| 필드 | 필수/선택 | Skip 가능 |
|------|-----------|-----------|
| 이름 | 필수 | N |
| 전화번호 | 필수 | N |
| 주소 | 필수 | N |
| 층수 | 선택 | N |
| 창 유형 | 선택 | Y |
| 규격 (가로/세로) | 선택 | Y |
| 갯수 | 선택 | Y |

---

## 11. 접근성 요구사항

- 모든 입력 필드에 `<label>` 연결
- 에러 메시지에 `role="alert"` 또는 `aria-live="polite"`
- 키보드만으로 전체 프로세스 완료 가능
- 포커스 순서: 입력 필드 → 건너뛰기 → 다음 버튼
- Progress indicator에 `aria-current="step"` 적용
