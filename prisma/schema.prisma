generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Lead {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())

  name      String
  email     String?
  phone     String?

  @@index([createdAt])
}

model Estimate {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())

  name          String?
  phone         String?

  zonecode      String
  address       String
  addressDetail String?

  windows       Json    // WindowInfo[]
  results       Json?   // BrandEstimate[]

  consultations Consultation[]

  @@index([phone])
  @@index([createdAt])
}

model Consultation {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())

  estimateId    String
  estimate      Estimate @relation(fields: [estimateId], references: [id])

  name          String?
  phone         String?

  preferredDays String[] // ['MON', 'TUE', ...]
  preferredTime String?

  status        String   @default("PENDING") // PENDING | CONTACTED | COMPLETED

  @@index([estimateId])
  @@index([status])
  @@index([createdAt])
}
